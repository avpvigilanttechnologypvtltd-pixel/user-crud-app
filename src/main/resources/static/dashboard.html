<!DOCTYPE html>
<html lang="en">
<head>
    <title>Dashboard</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
<div class="container mt-4">
    <h3>User Dashboard</h3>
    <table class="table table-bordered mt-3">
        <thead class="table-dark">
        <tr><th>ID</th><th>Username</th><th>Email</th><th>Actions</th></tr>
        </thead>
        <tbody id="userTableBody"></tbody>
    </table>
</div>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
function loadUsers() {
    $.get("/api/users", function(users) {
        let html = "";
        users.forEach(user => {
            html += `<tr>
                <td>${user.id}</td>
                <td><input value="${user.username}" id="u_${user.id}" class="form-control"></td>
                <td><input value="${user.email}" id="e_${user.id}" class="form-control"></td>
                <td>
                    <button onclick="updateUser(${user.id})" class="btn btn-sm btn-warning">Update</button>
                    <button onclick="deleteUser(${user.id})" class="btn btn-sm btn-danger">Delete</button>
                </td>
            </tr>`;
        });
        $("#userTableBody").html(html);
    });
}

function deleteUser(id) {
    $.ajax({
        url: "/api/users/" + id,
        type: "DELETE",
        success: loadUsers
    });
}

function updateUser(id) {
    $.ajax({
        url: "/api/users/" + id,
        method: "PUT",
        contentType: "application/json",
        data: JSON.stringify({
            username: $(`#u_${id}`).val(),
            email: $(`#e_${id}`).val(),
            password: "default"
        }),
        success: loadUsers
    });
}

$(document).ready(loadUsers);
</script>
</body>
</html>
